<!doctype html>
<html>
  <style type="text/css">
      body { font-family: arial; }
      thead tr td { font-weight: bold; }
      tr.success { background-color:#CCFFCC; }
      tr.fail { background-color:#FF3333; }
  </style>
    
  <script src="js/common.js"></script>
  <script src="js/regex2dfa.js"></script>
  <script src="js/benchmark.data.js"></script>
  <script src="js/benchmark.rabbit.js"></script>
  <script src="js/transformer.rabbit.js"></script>
      
    <script>
        function writeTable() {
            for (var i = 0; i < test_languages.length; i++) {
              var retval  = '';
              retval += '<tr id="row'+i+'">';
              retval += '<td class="testNum">'+(i+1)+'</td>';
              retval += '<td class="testInputLanguage">('+test_languages[i]['inputLanguageRegex']+', '+test_languages[i]['inputMaxLen']+')</td>';
              retval += '<td class="testInputLaguage">('+test_languages[i]['outputLanguageRegex']+', '+test_languages[i]['outputMaxLen']+')</td>';
              retval += '<td class="testCost">';
              retval += '-';
              retval += '</td>';
              retval += '</tr>';
              
              document.getElementById('benchmarkResults').innerHTML += retval;
            }
        }
        function fillTable(i) {
  
              retval = doBenchmark(test_languages[i]['inputLanguageDFA'], test_languages[i]['inputMaxLen'],
                                   test_languages[i]['outputLanguageDFA'], test_languages[i]['outputMaxLen'],
                                   test_languages[i]['key'], test_languages[i]['plaintext']);
              var success = retval[0];
              var elapsed = retval[1];
            
              var rowClass = 'fail';  
              if (success) {
                  rowClass = 'success';
              }
              

                 var toUpdate = document.getElementById('row'+i).className = rowClass;
                 var toUpdate = document.getElementById('row'+i).getElementsByClassName('testCost')[0];
                 toUpdate.innerHTML = elapsed;
             
        }
        window.onload = function(){ 
          writeTable();
          for (var i = 0; i < test_languages.length; i++) {
            (function(i) {
                setTimeout(function() {
              fillTable(i);
            },10)})(i);
          }
        };
    </script>
  
  <body>
    <table border="1" cellspacing="5">
      <thead>
      <tr>
          <td class="testNum">Test #</td>
          <td class="testInputLanguage">Input Language</td>
          <td class="testOutputLanguage">Output Language</td>
          <td class="testCost">Avg. Encrypt Cost (ms)</td>
      </tr>
    </thead>
    <tbody id="benchmarkResults"></tbody>
    </table>
      
  </body>
  
</html>

